# KITMS í™˜ê²½ ì„¤ì • ê°€ì´ë“œ

## ğŸ”§ í™˜ê²½ ë³€ìˆ˜ ë° ì„¤ì •

### 1. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

#### ê°œë°œ í™˜ê²½ (`application-dev.yml`)
```yaml
spring:
  datasource:
    url: jdbc:mariadb://localhost:3306/kitms
    username: kitms
    password: kitms123!
    driver-class-name: org.mariadb.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MariaDBDialect
        format_sql: true
```

#### í”„ë¡œë•ì…˜ í™˜ê²½ (`application-prod.yml`)
```yaml
spring:
  datasource:
    url: jdbc:mariadb://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:kitms}
    username: ${DB_USERNAME:kitms}
    password: ${DB_PASSWORD:kitms123!}
    driver-class-name: org.mariadb.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
```

### 2. ë¡œê¹… ì„¤ì •

#### ê°œë°œ í™˜ê²½
```yaml
logging:
  level:
    ROOT: DEBUG
    tech.jhipster: DEBUG
    org.hibernate.SQL: DEBUG
    com.kone.kitms: DEBUG
  file:
    name: ~/var/kitms/log/kitms_server_log.log
```

#### í”„ë¡œë•ì…˜ í™˜ê²½
```yaml
logging:
  level:
    ROOT: INFO
    com.kone.kitms: INFO
  file:
    name: ~/var/kitms/log/kitms_server_log.log
    max-size: 100MB
    max-history: 30
```

### 3. ë³´ì•ˆ ì„¤ì •

#### JWT ì„¤ì •
```yaml
jhipster:
  security:
    authentication:
      jwt:
        base64-secret: your-secret-key-here
        token-validity-in-seconds: 86400
        token-validity-in-seconds-for-remember-me: 2592000
```

#### ì´ë¯¸ì§€ ë³´ì•ˆ ì„¤ì •
```java
// SecureImageController.java
private static final long SESSION_TOKEN_EXPIRY_TIME = 2 * 60 * 60 * 1000; // 2ì‹œê°„
private static final long IMAGE_TOKEN_EXPIRY_TIME = 2 * 60 * 60 * 1000;   // 2ì‹œê°„
```

---

## ğŸš€ ë°°í¬ í™˜ê²½ë³„ ì„¤ì •

### 1. ê°œë°œ í™˜ê²½ ì‹¤í–‰
```bash
# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export SPRING_PROFILES_ACTIVE=dev
export DB_HOST=localhost
export DB_PORT=3306
export DB_NAME=kitms
export DB_USERNAME=kitms
export DB_PASSWORD=kitms123!

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
./mvnw spring-boot:run
```

### 2. í”„ë¡œë•ì…˜ í™˜ê²½ ì‹¤í–‰
```bash
# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export SPRING_PROFILES_ACTIVE=prod
export DB_HOST=your-db-host
export DB_PORT=3306
export DB_NAME=kitms
export DB_USERNAME=kitms
export DB_PASSWORD=your-secure-password

# JWT ì‹œí¬ë¦¿ í‚¤ ì„¤ì •
export JHIPSTER_SECURITY_AUTHENTICATION_JWT_BASE64_SECRET=your-base64-secret

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
java -jar target/kitms-0.0.1-SNAPSHOT.jar
```

### 3. Docker í™˜ê²½ ì‹¤í–‰
```bash
# Docker Compose ì‚¬ìš©
docker-compose up -d

# ë˜ëŠ” Docker ì§ì ‘ ì‹¤í–‰
docker run -d \
  --name kitms \
  -p 8080:8080 \
  -e SPRING_PROFILES_ACTIVE=prod \
  -e DB_HOST=your-db-host \
  -e DB_USERNAME=kitms \
  -e DB_PASSWORD=your-password \
  kitms:latest
```

---

## ğŸ“ ì¤‘ìš” íŒŒì¼ ìœ„ì¹˜

### ì„¤ì • íŒŒì¼
- `src/main/resources/config/application.yml`: ê¸°ë³¸ ì„¤ì •
- `src/main/resources/config/application-dev.yml`: ê°œë°œ í™˜ê²½ ì„¤ì •
- `src/main/resources/config/application-prod.yml`: í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì •
- `src/main/resources/config/application-image-paths.yml`: ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì •

### ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
- `src/main/resources/db/migration/`: Liquibase ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼
- `src/main/resources/db/changelog/`: ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ ë¡œê·¸

### ì •ì  íŒŒì¼
- `src/main/resources/static/`: HTML, CSS, JavaScript, ì´ë¯¸ì§€ íŒŒì¼
- `src/main/resources/static/images/`: ì´ë¯¸ì§€ íŒŒì¼ë“¤
- `src/main/resources/static/style/`: CSS íŒŒì¼ë“¤

### ë¡œê·¸ íŒŒì¼
- `~/var/kitms/log/kitms_server_log.log`: ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
- `~/var/kitms/log/kitms_server_log.YYYY-MM-DD_N.log`: ì¼ë³„ ë¡œê·¸ íŒŒì¼

---

## ğŸ” ëª¨ë‹ˆí„°ë§ ë° ë””ë²„ê¹…

### 1. í—¬ìŠ¤ ì²´í¬
```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ í™•ì¸
curl http://localhost:8080/management/health

# ìƒì„¸ ì •ë³´ í™•ì¸ (ê´€ë¦¬ì ê¶Œí•œ í•„ìš”)
curl http://localhost:8080/management/health/detail
```

### 2. ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
tail -f ~/var/kitms/log/kitms_server_log.log

# ì—ëŸ¬ ë¡œê·¸ë§Œ í™•ì¸
grep "ERROR" ~/var/kitms/log/kitms_server_log.log

# íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸ í™•ì¸
grep "2025-01-26 10:" ~/var/kitms/log/kitms_server_log.log
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
```sql
-- ì—°ê²° ìƒíƒœ í™•ì¸
SHOW PROCESSLIST;

-- í…Œì´ë¸” ìƒíƒœ í™•ì¸
SHOW TABLE STATUS;

-- ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
SHOW GRANTS FOR 'kitms'@'localhost';
```

---

## ğŸ› ï¸ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### 1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
```bash
# ì—°ê²° í…ŒìŠ¤íŠ¸
mysql -h localhost -u kitms -p kitms

# ë°©í™”ë²½ í™•ì¸
telnet localhost 3306

# MariaDB ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
systemctl status mariadb
```

### 2. í¬íŠ¸ ì¶©ëŒ ë¬¸ì œ
```bash
# í¬íŠ¸ ì‚¬ìš© í™•ì¸
netstat -tulpn | grep :8080

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill -9 $(lsof -t -i:8080)
```

### 3. ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ
```bash
# JVM í™ ë©”ëª¨ë¦¬ ì¦ê°€
java -Xmx2G -Xms1G -jar target/kitms-0.0.1-SNAPSHOT.jar

# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
free -h
top -p $(pgrep java)
```

### 4. ì´ë¯¸ì§€ ë¡œë”© ë¬¸ì œ
```bash
# ì´ë¯¸ì§€ íŒŒì¼ ê¶Œí•œ í™•ì¸
ls -la src/main/resources/static/images/

# í† í° ìƒíƒœ í™•ì¸ (API í˜¸ì¶œ)
curl http://localhost:8080/api/secure-images/mapping
```

---

## ğŸ“‹ ë°±ì—… ë° ë³µêµ¬

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
```bash
# ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
mysqldump -u kitms -p kitms > kitms_backup_$(date +%Y%m%d).sql

# íŠ¹ì • í…Œì´ë¸”ë§Œ ë°±ì—…
mysqldump -u kitms -p kitms kitms_user kitms_notice > tables_backup.sql
```

### 2. íŒŒì¼ ë°±ì—…
```bash
# ì •ì  íŒŒì¼ ë°±ì—…
tar -czf static_files_backup.tar.gz src/main/resources/static/

# ì„¤ì • íŒŒì¼ ë°±ì—…
cp -r src/main/resources/config/ config_backup/
```

### 3. ë³µêµ¬ ì ˆì°¨
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë³µêµ¬
mysql -u kitms -p kitms < kitms_backup_20250126.sql

# íŒŒì¼ ë³µêµ¬
tar -xzf static_files_backup.tar.gz
```

---

## ğŸ” ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì •ê¸° ë³´ì•ˆ ì ê²€
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ ê°•ë„ í™•ì¸
- [ ] JWT ì‹œí¬ë¦¿ í‚¤ ì£¼ê¸°ì  ë³€ê²½
- [ ] ì´ë¯¸ì§€ í† í° ë§Œë£Œ ì‹œê°„ ì ì ˆì„± ê²€í† 
- [ ] ë¡œê·¸ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ í™•ì¸
- [ ] ë°©í™”ë²½ ì„¤ì • ê²€í† 
- [ ] SSL/TLS ì¸ì¦ì„œ ìœ íš¨ì„± í™•ì¸

### ë³´ì•ˆ ì„¤ì • ê¶Œì¥ì‚¬í•­
```yaml
# í”„ë¡œë•ì…˜ í™˜ê²½ ë³´ì•ˆ ê°•í™”
server:
  servlet:
    session:
      cookie:
        secure: true
        http-only: true
        same-site: strict
  ssl:
    enabled: true
    key-store: classpath:keystore.p12
    key-store-password: your-keystore-password
```

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025ë…„ 1ì›” 26ì¼

